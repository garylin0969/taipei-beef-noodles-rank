# GitHub Actions 部署工作流程
# 當推送到 main 分支時自動觸發
name: Deploy to GitHub Pages

# 觸發條件
on:
    # 當推送到 main 分支時觸發
    push:
        branches: [main]

# 定義工作任務
jobs:
    # 建置和部署工作
    deploy:
        # 使用 Ubuntu 最新版作為執行環境
        runs-on: ubuntu-latest

        # 定義執行步驟
        steps:
            # 步驟 1: 檢出程式碼
            - name: Checkout
              uses: actions/checkout@v4

            # 步驟 2: 設定 Node.js 環境
            - name: Setup Node.js
              uses: actions/setup-node@v4
              with:
                  # 使用 Node.js 18 版本
                  node-version: '18'

            # 步驟 3: 設定 pnpm 套件管理器
            - name: Setup pnpm
              uses: pnpm/action-setup@v4
              with:
                  # 使用 pnpm 8 版本
                  version: 8

            # 步驟 4: 安裝專案依賴
            - name: Install dependencies
              run: pnpm install

            # 步驟 5: 執行程式碼檢查
            - name: Run linting
              run: pnpm lint

            # 步驟 6: 建置專案
            - name: Build project
              run: pnpm build

            # 步驟 7: 部署到 GitHub Pages
            - name: Deploy to GitHub Pages
              uses: peaceiris/actions-gh-pages@v4
              with:
                  github_token: ${{ secrets.GITHUB_TOKEN }}
                  publish_dir: ./dist
